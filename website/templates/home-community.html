<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>

      :root {
            --primary-color: #5de0e6;
            --secondary-color: #004aad;
            --shade1: #5dbec6;
        }

        body {
            font-family: "Anonymous Pro", sans-serif;
        }

        .container {
            width: 80%;
            margin: 0 auto;
            display: flex;
            justify-content: flex-end;
            align-items: flex-start;
            flex-wrap: wrap;
        }


        .middle {
            margin-top: 20px;
            margin-right: 20%;
            flex: 1 1 auto;
        }

        .create-event {
            width: 30%;
            margin-top: 80px;
            margin-right: 20px; 

        }

        .create-event input[type="text"],
        .create-event input[type="date"],
        .create-event input[type="time"],
        .create-event textarea,
        .create-event input[type="submit"] {
            display: block;
            width: 100%;
            margin-bottom: 10px;
            padding: 5px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }

        .create-event input[type="submit"] {
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
        }

        .create-event input[type="submit"]:hover {
            background-color: var(--secondary-color);
        }

        .events {

            margin-top: 40px; 
        }

        .event {
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 20px;
            position: relative;
        }

        .interaction-buttons {
            margin-top: 10px;
        }

        .interaction-buttons button {
            padding: 5px 10px;
            font-size: 14px;
            margin-right: 10px;
            cursor: pointer;
            border-radius: 5px;
            border: none;
        }

        .edit-delete-buttons {
            position: absolute;
            top: 10px;
            right: 10px;
        }
    </style>
</head>
<body>
    <!-- Main Content -->
    <main>
        <div class="container">
            <div class="middle">
                <!-- Create Event Form -->
                <form action="#" class="create-event">
                    <!-- Event Input Fields -->
                    <input type="hidden" id="eventId">
                    <input type="text" placeholder="Event Name" required>
                    <input type="text" placeholder="Location" required>
                    <input type="date" required>
                    <input type="time" required>
                    <textarea placeholder="Description"></textarea>
                    <!-- Submit Button -->
                    <input type="submit" value="Create Event">
                </form>

                <!-- Events Section -->
                <div class="events">
                    <!-- Event Templates will be appended here -->
                </div>
            </div>
        </div>
    </main>

    <!-- JavaScript -->
    <script>
        // Load events from localStorage on page load
        window.addEventListener('load', function() {
            const storedEvents = JSON.parse(localStorage.getItem('events')) || [];
            storedEvents.forEach(event => appendEvent(event));
        });

        // Function to handle event creation or editing
        document.querySelector('.create-event').addEventListener('submit', function(event) {
            event.preventDefault();

            // Get form values
            const eventId = this.querySelector('#eventId').value || Date.now(); // Unique ID for new event
            const eventName = this.querySelector('input[placeholder="Event Name"]').value;
            const location = this.querySelector('input[placeholder="Location"]').value;
            const date = this.querySelector('input[type="date"]').value;
            const time = this.querySelector('input[type="time"]').value;
            const description = this.querySelector('textarea').value;

            // Create event object
            const eventObj = {
                id: eventId,
                eventName,
                location,
                date,
                time,
                description,
                likes: 0,
                dislikes: 0
            };

            // Append or update event template to DOM
            if (eventId) {
                updateEvent(eventObj);
            } else {
                appendEvent(eventObj);
            }

            // Add event to localStorage
            const storedEvents = JSON.parse(localStorage.getItem('events')) || [];
            const existingIndex = storedEvents.findIndex(e => e.id === eventId);
            if (existingIndex !== -1) {
                storedEvents[existingIndex] = eventObj; // Update existing event
            } else {
                storedEvents.push(eventObj); // Add new event
            }
            localStorage.setItem('events', JSON.stringify(storedEvents));

            // Reset form
            this.reset();
        });

        // Function to append event template to DOM
        function appendEvent(event) {
            const eventsContainer = document.querySelector('.events');

            // Create event template
            const eventTemplate = `
                <div class="event" data-id="${event.id}">
                    <h2>${event.eventName}</h2>
                    <p><strong>Location:</strong> ${event.location}</p>
                    <p><strong>Date:</strong> ${event.date}</p>
                    <p><strong>Time:</strong> ${formatTime(event.time)}</p>
                    <p><strong>Description:</strong> ${event.description}</p>
                    <div class="interaction-buttons">
                        <button class="like-btn" data-type="like">Like</button>
                        <span>${event.likes}</span>
                        <button class="like-btn" data-type="dislike">Dislike</button>
                        <span>${event.dislikes}</span>
                    </div>
                    <div class="edit-delete-buttons">
                        <button class="edit-btn">Edit</button>
                        <button class="delete-btn">Delete</button>
                    </div>
                </div>
            `;

            // Append event template to container
            eventsContainer.innerHTML += eventTemplate;
        }

        // Function to update event template in DOM
        function updateEvent(event) {
            const eventsContainer = document.querySelector('.events');
            const existingEvent = eventsContainer.querySelector(`[data-id="${event.id}"]`);

            if (existingEvent) {
                existingEvent.innerHTML = `
                    <h2>${event.eventName}</h2>
                    <p><strong>Location:</strong> ${event.location}</p>
                    <p><strong>Date:</strong> ${event.date}</p>
                    <p><strong>Time:</strong> ${formatTime(event.time)}</p>
                    <p><strong>Description:</strong> ${event.description}</p>
                    <div class="interaction-buttons">
                        <button class="like-btn" data-type="like">Like</button>
                        <span>${event.likes}</span>
                        <button class="like-btn" data-type="dislike">Dislike</button>
                        <span>${event.dislikes}</span>
                    </div>
                    <div class="edit-delete-buttons">
                        <button class="edit-btn">Edit</button>
                        <button class="delete-btn">Delete</button>
                    </div>
                `;
            }
        }

        // Function to format time as HH:MM AM/PM
        function formatTime(time) {
            const parts = time.split(':');
            const hours = parseInt(parts[0]);
            const minutes = parseInt(parts[1]);

            const ampm = hours >= 12 ? 'PM' : 'AM';

            const formattedHours = hours % 12 || 12;

            const formattedMinutes = minutes < 10 ? `0${minutes}` : minutes;

            return `${formattedHours}:${formattedMinutes} ${ampm}`;
        }

        // Event delegation to handle like and dislike button clicks, edit and delete button clicks
        document.querySelector('.events').addEventListener('click', function(event) {
            const target = event.target;
            if (target.classList.contains('like-btn')) {
                const type = target.dataset.type;
                const parentEvent = target.closest('.event');
                const likeCount = parentEvent.querySelector('span:first-of-type');
                const dislikeCount = parentEvent.querySelector('span:last-of-type');

                if (type === 'like') {
                    likeCount.textContent = parseInt(likeCount.textContent) + 1;
                } else if (type === 'dislike') {
                    dislikeCount.textContent = parseInt(dislikeCount.textContent) + 1;
                }
            } else if (target.classList.contains('delete-btn')) {
                // Delete event
                const parentEvent = target.closest('.event');
                const eventId = parseInt(parentEvent.dataset.id);

                // Remove event from DOM
                parentEvent.remove();

                // Remove event from localStorage
                const storedEvents = JSON.parse(localStorage.getItem('events')) || [];
                const updatedEvents = storedEvents.filter(event => event.id !== eventId);
                localStorage.setItem('events', JSON.stringify(updatedEvents));
            } else if (target.classList.contains('edit-btn')) {
                // Edit event
                const parentEvent = target.closest('.event');
                const eventId = parseInt(parentEvent.dataset.id);
                const storedEvents = JSON.parse(localStorage.getItem('events')) || [];
                const eventToEdit = storedEvents.find(event => event.id === eventId);

                // Populate create event form with event details
                const createEventForm = document.querySelector('.create-event');
                createEventForm.querySelector('#eventId').value = eventToEdit.id;
                createEventForm.querySelector('input[placeholder="Event Name"]').value = eventToEdit.eventName;
                createEventForm.querySelector('input[placeholder="Location"]').value = eventToEdit.location;
                createEventForm.querySelector('input[type="date"]').value = eventToEdit.date;
                createEventForm.querySelector('input[type="time"]').value = eventToEdit.time;
                createEventForm.querySelector('textarea').value = eventToEdit.description;
            }
        });
    </script>
</body>
</html>